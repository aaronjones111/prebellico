# prebellico
Passive internal reconnaissance tool

Prebellico in its simplest form is a 100% passive network reconnaissance tool designed to gather as much information about the target environment without transmission. Execution is simple. Simply launch Prebellico with python as a root user at startup or within a GNU Screen session and the information it gathers will be dumped to the screen as well as logged within a specific location. By default Prebellio will only operate in a 100% passive state, while working to ignore traffic generated by the sniffing interface. If more specific functionality is desired, simply leverage the various options built into Prebellico:

root@soluto:~# python ./prebellico.py -h
usage: prebellico.py.beta [-h] [-i INF] [-f FILE] [-l LOG] [-d DB] [-e EXTRA]
                          [-t TARGETS] [-w WAIT] [-s] [-p] [-a] [-q]

optional arguments:
  -h, --help&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;show this help message and exit<br />
  -i INF, --inf INF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Specify the interface you want Prebellico to listen<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;on. By default Prebellico will hunt for interfaces and<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ask the user to specify an interface if one is not<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;provided here.<br />
  -f FILE, --file FILE  Specify a PCAP file to read from instead of a network<br />
                        interface. By default Prebellico assumes that traffic<br />
                        is to be read from a network interface.<br />
  -l LOG, --log LOG     Specify an output file. By default Prebellico will log<br />
                        to "prebellico.out" if a logfile is not specified.<br />
  -d DB, --db DB        Specify an sqlite db file you want to write to. By<br />
                        default this will create, if need be, and write to<br />
                        "prebellico.db" if not specified by the user, as long<br />
                        as the file is an actual Prebellico DB that the user<br />
                        can read from.<br />
  -e EXTRA, --extra EXTRA<br />
                        Specify extra filtering using PCAP based syntax. By<br />
                        default, "ip or arp or aarp and not host 0.0.0.0 and<br />
                        not host <interface_IP>" is used as a filter.<br />
  -t TARGETS, --targets TARGETS<br />
                        Specify targets of interest.<br />
  -w WAIT, --wait WAIT  Specify a period of time in hours to wait for new<br />
                        intelligence before shifting to a new form of<br />
                        intelligence gathering.<br />
  -s, --subsume         Include traffic from the target interface from<br />
                        Prebellico output. By default this traffic is excluded<br />
                        to ensure data generated by the interface while<br />
                        interacting with the environment does not taint the<br />
                        "fingerprint" of the target environment.<br />
  -p, --semipassive     Perform semi-passive data collection after a specified<br />
                        period of time where no new passive intelligence is<br />
                        aquired.<br />
  -a, --semiaggressive  Perform semi-aggressive data collection after a<br />
                        specififed period of time where no new passive or<br />
                        semi-passive intelligence is aquired.<br />
  -q, --quiet           Remove the Prebellico banner at the start of the<br />
                        script.<br />

Note that Prebellico has the ability to process a PCAP file with a maximum SNAPLEN of 262144 bytes prior to an engagement. This is useful for things like processing historical data obtained elsewhere or for scope validation purposes prior to engagement kickoff. You can also merge this data during the engagement by copying the database over and specifying the database and logfile at launch time, if so desired.

Soon prebellico will start to track the time between intelligence updates, and if so desired, work to move into a semi-passive mode after a user defined period of lack of intelligence, or after a specific period, leveraging the information it has obtained to further enumerate resources within the environment.

Prebellico also has the ability to understand what is permitted within the environment from network egress point. Eventually Prebellico, if told to do so, will leverage this information and establish a C2 connection using observed egress patters to report back to a listener the information it knows about a network.
